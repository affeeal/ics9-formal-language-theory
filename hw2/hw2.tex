\documentclass{article}

\usepackage{amsfonts}
\usepackage[english,russian]{babel}
\usepackage{csquotes}
\usepackage{enumerate}
\usepackage{mathtools}

\begin{document}

\section{Решение задачи 1}

Пусть $\mathcal{L}$ --- язык сентенциальных форм, порождаемых грамматикой
\begin{enumerate}[I]
  \item $S \to aSSbS$,
  \item $S \to bSb$,
  \item $S \to a$,
\end{enumerate}
и содержащих одинаковое число встречающихся в них термов. Рассмотрим слово
$w_0 = a^3 b (a S^2 b)^2 b S b$. Заметим, что $w_0 \in \mathcal{L}$.
Действительно, $|w_0|_a = |w_0|_b = |w_0|_S = 5$, а само $w_0$ получается
применением к стартовому нетерминалу $S$ трёх правил грамматики I, одного
правила II и двух правил III.

Если применить к $w_0$ четыре правила I, одно правило II и два правила III,
получим слово $w_1 = (a^3 b)^2 (a S^2 b)^5 b^2 S b^2 \in \mathcal{L}$,
$|w_1|_a = |w_1|_b = |w_1|_S = 11$, причём $w_1$ --- \textquote{наименьшее}
слово языка, получаемое из $w_0$.

Аналогично, применение четырёх правил I, одного правила II и двух правил III
к $w_1$ порождает $w_2 = (a^3 b)^3 (a S^2 b)^8 b^3 S b^3 \in \mathcal{L}$,
$|w_2|_a = |w_2|_b = |w_2|_S = 17$, и $w_2$ --- \textquote{наименьшее} слово
языка, получаемое из $w_1$.

В общем случае получаем $w_i = (a^3 b)^{i+1} (a S^2 b)^{3i+2} b^{i+1} S b^{i+1}$,
где $|w_i|_a = |w_i|_b = |w_i|_S = 6i + 5$. Покажем, что язык
$\mathcal{L} \notin \mathtt{CFG}$, применяя лемму о накачке для $\mathtt{CFL}$
к слову $w_i$. Будем предполагать выполненным пересечение с регулярной
аппроксимацией $\mathcal{R} = (a^3 b)^+ (a S^2 b)^+ b^+ S b^+$.

Пусть $n$ --- длина накачки, и пусть
$w = (a^3 b)^{n+1} (a S^2 b)^{3n+2} b^{n+1} S b^{n+1}$. Рассмотрим всевозможные
разбиения $w = w_0 w_1 w_2 w_3 w_4$, $|w_1 w_3| > 0$, $|w_1 w_2 w_3| \le n$, и
покажем, что $w$ не накачивается.

\begin{enumerate}
  \item $w_1 w_3 = (a^3 b)^i$ для некоторого $i$ (заметим, что при ином 
    выборе фрагментов накачек в $(a^3 b)^{n+1}$ слово выпадает из языка в силу
    пересечения с $\mathcal{R}$). Тогда при отрицательной накачке в слове
    уменьшится число букв $a$, $b$, но число букв $S$ останется неизменным ---
    слово окажется не в языке;

  \item $w_1 = (a^3 b)^i$, $w_3 = (a S^2 b)^j$ для некоторых $i$, $j$.
    Аналогично, при выборе других фрагментов накачек в $(a^3 b)^{n+1}$ и
    $(a S^2 b)^{3n+2}$ соответственно слово оказывается не в языке.
    Отрицательной накачкой удаляется большее число букв $a$, чем $b$ и $c$;

  \item $w_1 w_3 = (a S^2 b)^{i}$ для некоторого $i$. Вновь отрицательная
    накачка удаляет из слова букв $S$ больше, чем $a$, $b$;

  \item $w_1 = (a S^2 b)^{i}$, $w_3 = b^j$ для некоторых $i$, $j$. С
    отрицательной накачкой в слове остаётся различное число букв;

  \item $w_1 w_3 = b^i$ для некоторого $i$. Отрицательная накачка удаляет в
    слове только буквы $b$;

  \item случай $w_1 = b^i$, $w_3 = b^j$ для некоторых $i$, $j$ аналогичен
    предыдущему.
\end{enumerate}

Таким образом, при любом разбиении слово оказывается не в языке (даже не за
счёт невозможности вывести данную сентенциальную форму, а просто из-за
дисбаланса термов --- всё благодаря пересечению с $\mathcal{R}$). Язык
$\mathcal{L} \notin \mathtt{CFL}$.

\section{Решение задачи 2}

Пусть $\mathcal{L} = \{c^i a^n b^k a^j \, | \, (k > n) \lor (i = j \, \& \,
n > 2)\}$. Язык $\mathcal{L} \in \mathtt{CFL}$, поскольку $\mathcal{L} =
\mathcal{L}_1 \cup \mathcal{L}_2$, где

\[\mathcal{L}_1 = \{c^i a^n b^k a^j \, | \, k > n\} \in \mathtt{CFL},\]
\[\mathcal{L}_2 = \{c^i a^n b^k a^j \, | \, i = j \, \& \, n > 2 \} \in \mathtt{CFL}.\]

Язык $\mathcal{L}$ недетерминирован. Докажем это с помощью леммы о накачке
для $\mathtt{DCFL}$. Пусть $n$ --- длина накачки. Рассмотрим слова

\[w_1 = c^n a^{n+2} \in \mathcal{L},\]
\[w_2 = c^n a^{n+2} b a^n \in \mathcal{L}.\]

У них общий префикс $x = c^n a^{n+1}$, $|x| > n$, и различные суффиксы
$y = a$ и $z = a b a^n$ соответственно, причём $y[0] = z[0]$. Будем предполагать
выполненным пересечение с регулярной аппроксимацией $c^* a^2 a^* b? a^*$.

Пусть накачивается только префикс $x$, т.е. существует разбиение $x = x_0 x_1 x_2 x_3
x_4$, $|x_1 x_3| > 0$, $|x_1 x_2 x_3| \le n$, такое, что $(\forall i \in
\mathbb{N})$ $x_0 x_1^i x_2 x_3^i x_4 y \in \mathcal{L}$ и $x_0 x_1^i x_2
x_3^i x_4 z \in \mathcal{L}$. Рассмотрим разбиения префикса $x$.

\begin{itemize}
  \item $x_1 x_3 = c^i$ для некоторого $i$. Отрицательная накачка
    рассинхронизирует число букв $c$ и $a$ в слове $w_1$;
  \item $x_1 = c^i$, $x_3 = a^j$ для некоторых $i$, $j$. При отрицательной
    накачке наблюдаем рассинхронизацию числа букв $c$ и $a$ уже в слове $w_2$;
  \item $x_1 x_3 = a^i$ для некоторого $i$. Вновь отрицательная накачка
    рассинхронизирует число букв $c$ и $a$ в слове $w_1$.
\end{itemize}

Пусть теперь префикс $x$ и суффиксы $y$, $z$ накачиваются синхронно, т.е.
существуют разбиения $x = x_0 x_1 x_2$, $y = y_0 y_1 y_2$, $z = z_0 z_1 z_2$,
где $|x_1 x_2| \le n$, $|x_1| > 0$, такие, что $(\forall i \in \mathbb{N})$
$x_0 x_1^i x_2 y_0 y_1^i y_2 \in \mathcal{L}$ и $x_0 x_1^i x_2 z_0 z_1^i z_2
\in \mathcal{L}$. Заметим, что $x_1 = a^i$ для некоторого i. Какое бы мы ни
выбрали разбиение $y$ ($y_1 = a$ или $y_1 = \varepsilon$), при отрицательной
накачке слово $w_1$ выходит из языка из-за рассинхронизации числа букв $a$ и
$c$.

Таким образом, $\mathcal{L} \notin \mathtt{DCFL}$.

\end{document}
